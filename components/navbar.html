<!-- navbar  -->
<style>
  .nav-links a {
    position: relative;
    text-decoration: none;
    color: #666;
    transition: color 0.3s ease;
    padding: 0.5rem 0;
  }

  .nav-links a:hover {
    color: #333;
  }

  .nav-links a.active {
    color: #000;
    font-weight: 500;
  }

  .nav-links a.active::after {
    content: "";
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 2px;
    background-color: #000;
    transform: scaleX(1);
    transform-origin: left;
    transition: transform 0.3s ease;
  }

  .nav-links a::after {
    content: "";
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    height: 2px;
    background-color: #000;
    transform: scaleX(0);
    transform-origin: right;
    transition: transform 0.3s ease;
  }

  .nav-links a:hover::after {
    transform: scaleX(1);
    transform-origin: left;
  }

  /* Base navbar styles */
  nav {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1.5rem 3rem;
    background-color: var(--paper);
    position: fixed;
    border-radius: 10px;
    top: 1%;
    width: 90%;
    left: 50%;
    transform: translateX(-50%);
    box-shadow: var(--shadow);
    z-index: 1050;
  }

  /* Mobile menu button */
  .mobile-menu-btn {
    display: none;
    background: none;
    border: none;
    padding: 0.5rem;
    cursor: pointer;
    z-index: 1002;
    position: relative;
    /* background-color: rgba(0, 0, 0, 0.1); */
    border-radius: 4px;
  }

  .mobile-menu-btn span {
    display: block;
    width: 25px;
    height: 2px;
    background-color: var(--dark);
    margin: 5px 0;
    transition: all 0.3s ease;
  }

  /* Drawer menu */
  .drawer-menu {
    position: fixed;
    top: auto;
    bottom: -100%;
    left: 0;
    width: 100%;
    max-width: none;
    height: auto;
    max-height: 80vh;
    background-color: var(--paper);
    box-shadow: 0 -5px 15px rgba(0, 0, 0, 0.1);
    padding: 2rem 1rem;
    z-index: 1001;
    transform: translateY(100%);
    transition: transform 0.3s ease;
    display: flex;
    flex-direction: column;
  }

  .drawer-menu.active {
    transform: translateY(0);
  }

  .drawer-menu .nav-links {
    flex-direction: column;
    gap: 1rem;
    align-items: center;
  }

  .drawer-menu .nav-links a {
    font-size: 1.2rem;
    padding: 0.75rem 0;
  }

  .drawer-menu .contact-button {
    margin-top: 1.5rem;
    width: 80%;
    max-width: 250px;
    margin-left: auto;
    margin-right: auto;
  }

  .drawer-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
    z-index: 1000;
  }

  .drawer-overlay.active {
    opacity: 1;
    visibility: visible;
  }

  /* Mobile menu button active state */
  .mobile-menu-btn.active span:nth-child(1) {
    transform: rotate(45deg) translate(5px, 5px);
  }

  .mobile-menu-btn.active span:nth-child(2) {
    opacity: 0;
  }

  .mobile-menu-btn.active span:nth-child(3) {
    transform: rotate(-45deg) translate(7px, -7px);
  }

  @media (max-width: 768px) {
    nav {
      top: 0;
      left: 0;
      width: 100%;
      transform: none;
      border-radius: 0;
      padding: 1rem;
      box-sizing: border-box;
      z-index: 100;
    }

    .mobile-menu-btn {
      display: block;
      padding: 0.5rem;
      box-sizing: border-box;
    }

    nav .nav-links {
      display: none;
    }

    nav .contact-button {
      display: none;
    }

    .logo span {
      font-size: 16px;
    }

    .logo img {
      height: 24px;
    }
  }
</style>

<script src="/assets/js/base.js" defer></script>

<script>
  // Immediate logging to verify script execution
  console.log("Navbar script starting...");

  document.addEventListener("DOMContentLoaded", function () {
    console.log("DOM Content Loaded - Setting up menu...");

    // Immediate check for menu button
    const mobileMenuBtn = document.querySelector(".mobile-menu-btn");
    console.log("Initial menu button check:", mobileMenuBtn);

    // Add click handler directly to the button element
    if (mobileMenuBtn) {
      mobileMenuBtn.onclick = function (e) {
        console.log("Direct click handler triggered");
        e.preventDefault();
        e.stopPropagation();
        alert("Menu button clicked!"); // Temporary alert to verify click
      };
    }

    const currentPage =
      window.location.pathname.split("/").pop() || "index.html";
    const navLinks = {
      "index.html": ["nav-home", "drawer-nav-home"],
      "about.html": ["nav-about", "drawer-nav-about"],
      "units.html": ["nav-units", "drawer-nav-units"],
    };

    const activeLinkIds = navLinks[currentPage] || [];
    activeLinkIds.forEach((id) => {
      const element = document.getElementById(id);
      if (element) {
        element.classList.add("active");
      }
    });

    // Mobile menu functionality
    const drawerMenu = document.querySelector(".drawer-menu");
    const drawerOverlay = document.querySelector(".drawer-overlay");

    // Debug state tracking
    let menuState = {
      isOpen: false,
      lastAction: null,
      timestamp: null,
    };

    function logMenuState(action) {
      menuState.isOpen = drawerMenu.classList.contains("active");
      menuState.lastAction = action;
      menuState.timestamp = new Date().toISOString();
      console.log("Menu State:", {
        isOpen: menuState.isOpen,
        action: menuState.lastAction,
        time: menuState.timestamp,
        menuButton: mobileMenuBtn.classList.contains("active"),
        drawerMenu: drawerMenu.classList.contains("active"),
        overlay: drawerOverlay.classList.contains("active"),
      });
    }

    if (!mobileMenuBtn || !drawerMenu || !drawerOverlay) {
      console.error("Required elements not found:", {
        mobileMenuBtn: !!mobileMenuBtn,
        drawerMenu: !!drawerMenu,
        drawerOverlay: !!drawerOverlay,
      });
      return;
    }

    // Log the actual HTML of the button
    console.log("Menu button HTML:", mobileMenuBtn.outerHTML);
    console.log("Menu button styles:", window.getComputedStyle(mobileMenuBtn));
    console.log(
      "Menu button display:",
      window.getComputedStyle(mobileMenuBtn).display
    );

    function openMenu() {
      console.log("Attempting to open menu...");
      mobileMenuBtn.classList.add("active");
      drawerMenu.classList.add("active");
      drawerOverlay.classList.add("active");
      document.body.style.overflow = "hidden";
      logMenuState("open");
    }

    function closeMenu() {
      console.log("Attempting to close menu...");
      mobileMenuBtn.classList.remove("active");
      drawerMenu.classList.remove("active");
      drawerOverlay.classList.remove("active");
      document.body.style.overflow = "";
      logMenuState("close");
    }

    function toggleMenu(e) {
      console.log("Toggle menu triggered", {
        event: e ? e.type : "programmatic",
        currentState: menuState.isOpen,
      });

      if (e) {
        e.preventDefault();
        e.stopPropagation();
      }

      const isOpen = drawerMenu.classList.contains("active");
      if (isOpen) {
        closeMenu();
      } else {
        openMenu();
      }
    }

    // Add a more direct event listener
    mobileMenuBtn.addEventListener(
      "click",
      function (e) {
        console.log("Menu button clicked - direct listener");
        alert("Menu button clicked!"); // Temporary alert to verify click
        toggleMenu(e);
      },
      true
    ); // Using capture phase

    // Also try mousedown event
    mobileMenuBtn.addEventListener("mousedown", function (e) {
      console.log("Menu button mousedown");
    });

    // Close menu when clicking a link
    const drawerLinks = drawerMenu.querySelectorAll("a");
    drawerLinks.forEach((link) => {
      link.addEventListener("click", (e) => {
        console.log("Drawer link clicked", {
          link: link.href,
          currentMenuState: menuState.isOpen,
        });
        closeMenu();
      });
    });

    // Close menu on escape key
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape" && drawerMenu.classList.contains("active")) {
        console.log("Escape key pressed", {
          currentMenuState: menuState.isOpen,
        });
        closeMenu();
      }
    });

    // Close menu on window resize if open
    window.addEventListener("resize", () => {
      if (window.innerWidth > 768 && drawerMenu.classList.contains("active")) {
        console.log("Window resized to desktop width", {
          width: window.innerWidth,
          currentMenuState: menuState.isOpen,
        });
        closeMenu();
      }
    });

    // Log initial state
    logMenuState("initialized");
  });

  // Add a global click handler to see if clicks are being registered
  document.addEventListener("click", function (e) {
    console.log("Document click:", e.target);
  });
</script>

<nav>
  <a href="index.html" class="logo">
    <img src="assets/icons/logo.svg" alt="BVR Innovation Group" />
    <span>BVR Innovation Group</span>
  </a>

  <!-- Add onclick directly to the button -->
  <button
    class="mobile-menu-btn"
    aria-label="Toggle menu"
    onclick="console.log('Inline click handler')"
  >
    <span></span>
    <span></span>
    <span></span>
  </button>

  <div class="nav-links">
    <a href="index.html" id="nav-home">Home</a>
    <a href="about.html" id="nav-about">About</a>
    <a href="units.html" id="nav-units">Our Units</a>
    <!-- <a href="#" id="nav-contact" data-modal="contact">Contact</a> -->
  </div>
  <button data-modal="contact" class="contact-button">Contact us</button>
</nav>

<!-- Drawer Menu -->
<div class="drawer-overlay"></div>
<div class="drawer-menu">
  <div class="nav-links">
    <a href="index.html" id="drawer-nav-home">Home</a>
    <a href="about.html" id="drawer-nav-about">About</a>
    <a href="units.html" id="drawer-nav-units">Our Units</a>
  </div>
  <button data-modal="contact" class="contact-button">Contact us</button>
</div>
